  
/**  
 * @throws ExceptionInterface  
 * @throws DtoValidateException  
 * @throws ProducerSendException  
 */#[OA\Delete(  
    path: "/{productId}",  
    summary: "Remove one or more products from wishlist",  
    requestBody: new OA\RequestBody(  
        content: new OA\JsonContent(  
            type: "array",  
            items: new OA\Items(type: "integer")  
        )  
    ),  
    tags: ["Wishlist"],  
    parameters: [  
        new OA\Parameter(  
            name: "productId",  
            in: "path",  
            required: false,  
            schema: new OA\Schema(  
                type: "integer",  
                pattern: "\d+"  
            )  
        ),  
        new OA\Parameter(  
            name: "X-Visitor-Id",  
            in: "header",  
            schema: new OA\Schema(  
                type: "string"  
            )  
        ),  
    ],  
    responses: [  
        new OA\Response(  
            response: 204,  
            description: "Deleted"  
        ),  
        new OA\Response(ref: "#/components/responses/Unauthorized", response: 401),  
        new OA\Response(ref: "#/components/responses/Forbidden", response: 403),  
    ]  
)]  
#[Route(path: "/{productIds}", methods: ["DELETE"])]  
public function delete(string $productIds, WishlistService $service, Request $request): JsonResponse  
{  
    $ids = array_filter(  
        array_map('trim', explode(',', $productIds)),  
        fn($id) => ctype_digit($id)  
    );  
  
    if (empty($ids)) {  
        return $this->json(null, Response::HTTP_NO_CONTENT);  
    }  
  
    $service->deleteItems(  
        $this->getCustomerId(),  
        $this->getWebsiteId(),  
        $request->headers->get('x-visitor-id'),  
        array_map('intval', $ids)  
    );  
  
    return $this->json(null, Response::HTTP_NO_CONTENT);  
}


  
/**  
 * @throws ExceptionInterface  
 * @throws DtoValidateException  
 * @throws ProducerSendException  
 */#[OA\Delete(  
    path: "/wishlist",  
    summary: "Remove multiple products from wishlist",  
    requestBody: new OA\RequestBody(  
        required: true,  
        content: new OA\JsonContent(  
            properties: [  
                new OA\Property(  
                    property: "productIds",  
                    type: "array",  
                    items: new OA\Items(type: "integer")  
                )  
            ],  
            type: "object"  
        )  
    ),  
    tags: ["Wishlist"],  
    parameters: [  
        new OA\Parameter(  
            name: "X-Visitor-Id",  
            in: "header",  
            schema: new OA\Schema(type: "string")  
        ),  
    ],  
    responses: [  
        new OA\Response(  
            response: 204,  
            description: "Deleted"  
        ),  
        new OA\Response(ref: "#/components/responses/Unauthorized", response: 401),  
        new OA\Response(ref: "#/components/responses/Forbidden", response: 403),  
    ]  
)]  
#[Route(path: "/list", methods: ["DELETE"])]  
public function deleteMultiple(Request $request, WishlistService $service): JsonResponse  
{  
    $data = json_decode($request->getContent(), true);  
    $productIds = $data['productIds'] ?? [];  
  
    $visitorId = $request->headers->get('x-visitor-id');  
    $service->deleteItems($this->getCustomerId(), $this->getWebsiteId(), $visitorId, $productIds);  
  
    return $this->json(null, Response::HTTP_NO_CONTENT);  
}



/**  
 * @throws ExceptionInterface  
 * @throws DtoValidateException  
 * @throws ProducerSendException  
 * @throws Exception  
 */public function deleteItems(int $customerId, int $websiteId, ?string $visitorId, array $productIds): void  
{  
    $this->logger->info('Deleting wishlist items for customer {customer}', ['customer' => $customerId]);  
  
    $this->wishlistRepository->deleteMultiple($customerId, ...$productIds);  
  
    $this->sendEvent(EventEnum::RemoveProduct, $visitorId, $websiteId, ...$productIds);  
    $this->sendCount(...$productIds);  
  
    $this->logger->debug('Wishlist items deleted', ['removed' => count($productIds)]);  
}